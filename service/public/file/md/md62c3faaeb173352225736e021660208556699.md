### 一.创建一个node项目

1.初始化：npm init

2.安装包：npm install 包名（express）

### 二.node里的导入和导出

1.导出module.exports

```js
//./code/add.js
function add(...temp){
	let a=0;
	temp.forEach((item)=>{
		a+=item;
	})
	return a;
}
let num=100;
/**
 * 导出方法/接口
 */
module.exports={
	add,
	num
};
```

2.导入require

```js
//index.js
/**
 * 导入方法/接口
 */
let {add,num}=require("./code/add.js");
console.log(num,add(1,2,3));//100 6
```

### 三.path ; url ; querystring ；fs ；stream

```js
/* 
    Path是node内置模块
*/

 let path = require("path");
// console.log(path);
//1.dirname(文件夹路径)和filename（文件路径）
// console.log(path.join(__dirname, "a.js")); //文件夹目录绝对路径 *
// console.log(path.join(__filename, "a.js"));//文件目录绝对路径
// console.log(path.join());  //.
// console.log(path.resolve(__dirname, "tool/match"));*
// console.log(path.resolve())
// console.log(  path.relative(__dirname+"/wanzi", __dirname+"./tool/match/index.js")  );
// D:\class\node\03
// console.log( path.parse(__filename) ); //解析文件路径*
// console.log( path.parse(__dirname) ); //解析文件夹路径
// let basename = path.basename("D:\\class\\node\\03"); //获取路径中最末尾的部分(文件名.后缀名/文件夹名)
// console.log(basename);
// console.log(path.delimiter);//方法将返回平台的真实路径，多个用 “:” 或 “;” 隔开。
//let extname = path.extname("D:\class\node\03\path.jsx");//返回.后面的
// console.log(extname);*
// console.log( path.parse(__filename) );
// let obj = {
//     root: 'D:\\',
//     dir: 'D:\\class\\node\\03',
//     base: 'path.js',
//     ext: '.js',
//     name: 'path'
// };
// console.log(path.format(obj)); //是parse的相反操作，把拆分后的对象 解析为一个路径
// console.log(path.isAbsolute("D:/class/node/03/path.jsx")); //判断路径是否为绝对路径，true表示是*
// console.log(path.isAbsolute("./03/path.jsx"));
// console.log(path.isAbsolute(""));
// console.log(path.normalize("D:\\class\\node\\03\\path.jsx")); //规范路径*  
```

```js
/**
 *  URL
 */
let { URL} = require("url");

console.log(URL);//[class URL]

let urlObj=new URL("https://tieba.baidu.com/f?kw=%E5%90%9B%E4%B8%B4%E5%A4%A9%E4%B8%8B&fr=index");
console.log(urlObj);
/**
 * URL {
  href: 'https://tieba.baidu.com/f?kw=%E5%90%9B%E4%B8%B4%E5%A4%A9%E4%B8%8B&fr=index',
  origin: 'https://tieba.baidu.com',
  protocol: 'https:',协议
  username: '',
  password: '',
  host: 'tieba.baidu.com',主机/域名
  hostname: 'tieba.baidu.com',主机名/域名
  port: '',端口号
  pathname: '/f',文件路径
  search: '?kw=%E5%90%9B%E4%B8%B4%E5%A4%A9%E4%B8%8B&fr=index',？号后面的字段（查询部分）
  searchParams: URLSearchParams { 'kw' => '君临天下', 'fr' => 'index' },
  hash: ''
}
 */

```

```js
/**
 *  querystring
 */

let queryString = require("querystring");
// console.log(queryString);
// let params = "wd=%E8%8D%89%E8%8E%93&pn=20&oq=%E8%8D%89%E8%8E%93&ie=utf-8&usm=4&rsv_pq=f71a4a0d000127a0&rsv_t=d861S664Rtx2wSL1UyiW9Ux%2BZJV2lEftIp8N3iI4NYasnUKLhPuLu6LKCuM";
let params = "wd:%E8%8D%89%E8%8E%93;pn:20;oq:%E8%8D%89%E8%8E%93;ie:utf-8;usm:4;rsv_pq:f71a4a0d000127a0;rsv_t:d861S664Rtx2wSL1UyiW9Ux%2BZJV2lEftIp8N3iI4NYasnUKLhPuLu6LKCuM";

// arg1:参数字符串   arg2:每对键值对的切割符，默认&   arg3: 键名与键值之间的分隔符,默认=
// console.log(queryString.parse(params, ";", ":", {
//     maxKeys: 2
// })); // 解析url后面的参数，转为键值对形式的对象


let dataObj = {
    wd: '草莓',
    pn: '20',
    oq: '草莓',
    ie: 'utf-8',
    usm: '4',
    rsv_pq: 'f71a4a0d000127a0'
}

console.log(queryString.stringify(dataObj, ";", ":"));


```

```js
/**
 *  fs
 */
let fs = require("fs");
// console.log(fs);

//检测路径文件是否存在。存在为true
// fs.exists("./tool/1.txt",(isResult)=>{
// 	console.log(isResult);
// })

//创建一个目录，如果该目录存在就报错
// fs.mkdir(`${__dirname}/about`,0777,(err)=>{
// 	console.log(err);
// })

//读取目录下的子级文件/文件夹的名字，不读取后代目录/文件名
/**
 * [
  'about',
  'fs.js',
  'path.js',
  'queryString.js',
  'stream.js',
  'tool',
  'url.js'
]
 */
// fs.readdir(`${__dirname}`,(err,data)=>{
// 	console.log(data);//返回一个数组
// })

//判断文件时真的文件还是文件夹
// fs.readdir(`${__dirname}`,(err,data)=>{
// 	console.log(data);//返回一个数组
// 	data.forEach((item)=>{
// 		fs.stat(item,(err,status)=>{
// 			console.log(item+"是",status.isFile());//判断是否是文件
// 			console.log(item+"是",status.isDirectory());//判断是否是文件夹
// 		})
// 	})
// })


//删除文件
// fs.unlink(__dirname+"/ddd/12.md",err=>{
// 	if(err)throw err
// 	console.log("删除成功");
// })
//删除文件夹，只能删除空文件夹
// fs.rmdir(__dirname+"/ddd",err=>{
// 	if(err)throw err
// 	console.log("删除成功");
// })

//文件移动和文件重命名同于个方法，重命名是地址一样
// fs.rename(__dirname + "/tool/1.txt", __dirname + "/about/2.txt",( err) => {
// 	if (err) throw err;
// 	console.log("文件移动成功");
// })

//读取文件
// fs.readFile(__dirname + "/about/2.txt","utf-8" ,(err,data)=>{
// 		if (err) throw err;
// 		console.log(data.toString());
// })

//写入文件
// let data1="ddsfsddadadadadadadadada"
// fs.writeFile(__dirname + "/about/2.txt",data1,(err)=>{
// 	console.log("写入成功");
// })

```

```js
/**
 *  stream
 */
/**
 * 数据流
 */
let fs=require("fs");
// let data=null;
// let stream= fs.createReadStream(__dirname+"/about/2.txt");//创建一个读取数据流
// stream.on("data",(txtData)=>{// 监听当前读取数据过程中的进度状态
// 	console.log(txtData.toString());
// 	console.log("-----------------------------------");
// 	data+=txtData
// })
// stream.on("end",()=>{//数据读取完成后触发
// 	console.log("数据读取完毕");
// })


// let Readstream= fs.createReadStream(__dirname+"/about/2.txt");//创建一个读取数据流
// let Writestream =fs.createWriteStream(__dirname+"/about/3.txt","utf-8")//创建一个写入数据流
// Readstream.on("data",(txtData)=>{
// 	Writestream.write(txtData)//把读取到的数据写入目标文件3.txt中
// })
// Readstream.on("end",()=>{
// 	Writestream.end();//写入完成
// 	console.log("读取完成");
// })


// let a = fs.createReadStream(`${__dirname}/wanzi.txt`).pipe(fs.createWriteStream(`${__dirname}/dddd.txt`));


```

### 四。buffer

```js
// console.log(Buffer);
/**
 * [Function: Buffer] {
  poolSize: 8192,
  from: [Function: from],
  of: [Function: of],
  alloc: [Function: alloc],
  allocUnsafe: [Function: allocUnsafe],
  allocUnsafeSlow: [Function: allocUnsafeSlow],
  isBuffer: [Function: isBuffer],
  compare: [Function: compare],
  isEncoding: [Function: isEncoding],
  concat: [Function: concat],
  byteLength: [Function: byteLength],
  [Symbol(kIsEncodingSymbol)]: [Function: isEncoding]
}
 */

// let buffer= new Buffer("hello word");
// console.log(buffer);//<Buffer 68 65 6c 6c 6f 20 77 6f 72 64>

// let buffer1 = new Buffer([0x68, 0x65 , 0x6c , 0x6c , 0x6f]);
// console.log(buffer1.toString());

// let buffer1 = new Buffer([0x68, 0x65 , 0x6c , 0x6c , 0x6f]);
// console.log(buffer1.length);//5

// let buffer1 = new Buffer("abcdefg");  //源对象
// let buffer2 = new Buffer(4);  //目标对象
// buffer1.copy(buffer2,0,2,5)//从目标对象第0项开始插入源对象的第2项到第5项（不包括5）内容
// console.log(buffer2.toString());//cde


// let buffer1 = new Buffer("abcdefg");  
// let buffer3 = new Buffer(buffer1); 
// console.log(buffer3);
// console.log(buffer1 === buffer3);//false

let buffer2=new Buffer(4);
buffer2.write("hh")
console.log(buffer2.toString());//hh
```

### 五。事件模块 events

```js
let Events = require("events"); //导入事件模块
// console.log(Events);

// 多状态/不同的状态做不同的操作    手动定义在什么时机下执行事件   

let ev1 = new Events() //创建实例对象

//on注册事件/绑定事件
// ev1.on("ww",()=>{  //事件名，事件函数
// 	console.log("第一个事件函数");
// })
// ev1.emit("ww")//  触发/执行事件      //第一个事件函数

// let a1 = () => {
// 	console.log("我是a1");
// }
// let a2 = () => {
// 	console.log("我是a2");
// }
// let a3 = () => {
// 	console.log("我是a3");
// }

// ev1.on("zz", a2)
// ev1.on("zz", a3)
// ev1.on("zz", a1)

// ev1.emit("zz") //我是a2 我是a3 我是a1


// let a1 = () => {
// 	console.log("我是a1");
// }
// let a2 = () => {
// 	console.log("我是a2");
// }
// let a3 = () => {
// 	console.log("我是a3");
// }
// ev1.on("zz",a1)
// function fun(){
// 	ev1.emit("zz")
// 	ev1.removeListener("zz",a1) //解绑事件 ，要求解绑的事件名/事件函数要和注册时候的事件名/事件函数完全一致
// }
// fun()
// fun()


let a1 = (str) => {
	console.log("我是a1"+str);
}
let a2 = (str) => {
	console.log("我是a2"+str);
}
let a3 = (str) => {
	console.log("我是a3"+str);
}
ev1.on("zz",a1)
ev1.on("zz",a2)
ev1.on("zz",a3)

function fun(){
	ev1.emit("zz","全部")
	ev1.removeListener("zz",a2)
}
fun()
fun()

// ev1.setMaxListeners(2); //指定同名事件下 绑定的事件函数数目上限为2个

// ev1.removeAllListeners(); //移除该对象下所有事件的回调函数 


```

### 六。http模块

```js
// let http = require("http");
// // console.log(http);

// //创建服务端
// http.createServer((request, response) => { //请求对象、响应对象
// 	//解析请求报文
// 	// console.log(request);
// 	let {
// 		url,
// 		method,
// 		headers
// 	} = request;
// 	// console.log(url);//    /
// 	// console.log(method);//   get
// 	// console.log(headers);

// 	// 对请求需要的资源做处理


// 	// 配置响应报文 : 响应状态码, 设置响应报文的首部（字段）       描述清楚需求/清楚的反馈给对方是什么内容
// 	response.writeHead(200, {
// 		"Content-type": "text/plian;charset=utf-8"
// 	})

// 	//响应主体/内容
// 	response.write("欢迎来到我的后端世界")

// 	//发送响应报文
// 	response.end()

// }).listen(8080, "127.0.0.1") //监听发送给127.0.0.1:8080端口的请求

//////////////////////////////////////////////////////////////////////////////////////////////////////////

// let http = require("http");
// let fs = require("fs")
// let {
// 	URL
// } = require("url")


// //创建服务端
// http.createServer((request, response) => { //请求对象、响应对象
// 	//解析请求报文
// 	let {
// 		url,
// 		method,
// 		headers
// 	} = request;

// 	if (url === "/") { //客户端想要访问主页面
// 		fs.readFile(`${__dirname}/index.html`, (err, data) => {
// 			response.writeHead(200, {
// 				"Content-type": "text/html"
// 			})
// 			response.write(data)
// 			response.end()
// 		})
// 	}else{
// 		console.log(`${__dirname}${url}`);
// 		fs.readFile(`${__dirname}${url}`, (err, data) => {
// 			response.writeHead(200, {
// 				"Content-type": "text/css"
// 			})
// 			response.write(data)
// 			response.end()
// 		})
// 	}

// }).listen(8080, "127.0.0.1") //监听发送给127.0.0.1:8080端口的请求

//////////////////////////////////////////////////////////////////////////////////

let http = require("http");
let fs = require("fs");
let {
	URL
} = require("url");
let path = require("path")


//创建服务端
http.createServer((request, response) => { //请求对象、响应对象
	//解析请求报文
	let {
		url,
		method,
		headers
	} = request;


	if (url === "/") { //客户端想要访问主页面
		fs.readFile(`${__dirname}/index.html`, (err, data) => {
			response.writeHead(200, {
				"Content-type": "text/html"
			})
			response.write(data)
			response.end()
		})
	} else {
		let fileType = "";
		switch (path.extname(url)) {
			case ".css":
				fileType = "text/css";
				break;
			case ".jpg":
				fileType = "image/jpg";
				break;
		}
		fs.readFile(`${__dirname}${url}`, (err, data) => {
					response.writeHead(200, {
						"Content-type": fileType
					})
					response.write(data)
					response.end()
				})
	}

}).listen(8080, "127.0.0.1") //监听发送给127.0.0.1:8080端口的请求

```

七。表单提交数据

```js
let http = require("http");
let {
	URL
} = require("url");
let fs = require("fs");
const formidable = require('formidable'); //导入formidable  用来解析form data
const path = require("path");
const {
	ifError
} = require("assert");
http.createServer((request, response) => { //请求对象/响应对象
	//   //解析请求报文
	//   let {url, method, headers} = request; 

	//   if(url == "/favicon.ico") return;

	//   // console.log(url, method, headers);

	//   let data = "";
	//   request.on("data", (chunk)=>{//chunk为前端提交的数据
	// // console.log(chunk.toString());
	//       data+=chunk;

	//   })

	//   request.on("end", ()=>{
	//       console.log(data); //打印客户端提交的数据内容
	//       response.writeHead(200, {
	//           "Content-Type":"text/html;charset=utf-8",  //纯文本类型
	//           "Access-Control-Allow-Origin": "*" //允许跨域
	//       });
	//       response.write("我收到你提交的数据内容啦!");
	//       response.end();
	//   })

	const form = formidable({
		multiples: true,
		uploadDir: "./myTemp" //指定文件的临时存储目录
	});
	form.parse(request, (err, fields, files) => { //fields表单上传的普通文本数据    files文件数据对象
		console.log(fields, "\n");
		console.log(files, "\n");

		let oldPath = files.files.filepath; //临时文件的完整路径
		let type = files.files.mimetype.split("/")[1]; //文件类型/后缀名
		let newPath = path.join(__dirname, `images/1.${type}`); //写入文件的目录路径

		console.log(files.files.filepath);
		console.log(type);
		console.log(newPath);


		fs.readFile(oldPath, (err, data) => {
			if (err) throw err
			fs.writeFile(newPath, data, (err) => {
				if (err) throw err
				console.log("写入成功");
			})
		})


	})
	response.writeHead(200, {
		"Content-type": "text/html;charset=utf-8",
		"Access-Control-Allow-Origin": "*"        //允许跨越
	})
	response.write("我收到了你提交的数据了！")
	response.end()



}).listen(8080, "127.0.0.1");

```

